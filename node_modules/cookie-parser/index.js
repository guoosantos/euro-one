function parseCookies(header = "") {
  return String(header)
    .split(";")
    .map((part) => part.trim())
    .filter(Boolean)
    .reduce((acc, pair) => {
      const [key, ...rest] = pair.split("=");
      acc[key] = rest.join("=");
      return acc;
    }, {});
}

export default function cookieParser() {
  return (req, _res, next) => {
    const header = req.headers?.cookie || "";
    req.cookies = parseCookies(header);
    next();
  };
}
